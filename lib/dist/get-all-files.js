"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const lodash_1 = require("lodash");
const FileMetadataDynamoDB_1 = require("./services/FileMetadataDynamoDB");
const fileMetadataTableName = process.env.FILE_METADATA_TABLE_NAME || '';
const dbService = new FileMetadataDynamoDB_1.FileMetadataDynamoDB(fileMetadataTableName);
exports.handler = async () => {
    try {
        const items = await dbService.scan();
        const uniqueFileIds = (0, lodash_1.uniq)(items.map(item => item.fileId));
        return {
            statusCode: 200,
            body: JSON.stringify(uniqueFileIds)
        };
    }
    catch (err) {
        console.error("Error fetching files:", err);
        return {
            statusCode: 500,
            body: "Failed to fetch files"
        };
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LWFsbC1maWxlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL2Z1bmN0aW9ucy9nZXQtYWxsLWZpbGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQThCO0FBQzlCLDBFQUF1RTtBQUV2RSxNQUFNLHFCQUFxQixHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLElBQUksRUFBRSxDQUFDO0FBQ3pFLE1BQU0sU0FBUyxHQUFHLElBQUksMkNBQW9CLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUVsRSxPQUFPLENBQUMsT0FBTyxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQ3pCLElBQUk7UUFDQSxNQUFNLEtBQUssR0FBUSxNQUFNLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUMxQyxNQUFNLGFBQWEsR0FBRyxJQUFBLGFBQUksRUFBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFFM0QsT0FBTztZQUNILFVBQVUsRUFBRSxHQUFHO1lBQ2YsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDO1NBQ3RDLENBQUM7S0FDTDtJQUFDLE9BQU8sR0FBRyxFQUFFO1FBQ1YsT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUM1QyxPQUFPO1lBQ0gsVUFBVSxFQUFFLEdBQUc7WUFDZixJQUFJLEVBQUUsdUJBQXVCO1NBQ2hDLENBQUM7S0FDTDtBQUNMLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVuaXEgfSBmcm9tIFwibG9kYXNoXCI7XHJcbmltcG9ydCB7IEZpbGVNZXRhZGF0YUR5bmFtb0RCIH0gZnJvbSBcIi4vc2VydmljZXMvRmlsZU1ldGFkYXRhRHluYW1vREJcIjtcclxuXHJcbmNvbnN0IGZpbGVNZXRhZGF0YVRhYmxlTmFtZSA9IHByb2Nlc3MuZW52LkZJTEVfTUVUQURBVEFfVEFCTEVfTkFNRSB8fCAnJztcclxuY29uc3QgZGJTZXJ2aWNlID0gbmV3IEZpbGVNZXRhZGF0YUR5bmFtb0RCKGZpbGVNZXRhZGF0YVRhYmxlTmFtZSk7XHJcblxyXG5leHBvcnRzLmhhbmRsZXIgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1zOiBhbnkgPSBhd2FpdCBkYlNlcnZpY2Uuc2NhbigpO1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZUZpbGVJZHMgPSB1bmlxKGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uZmlsZUlkKSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDIwMCxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodW5pcXVlRmlsZUlkcylcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGZpbGVzOlwiLCBlcnIpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDUwMCxcclxuICAgICAgICAgICAgYm9keTogXCJGYWlsZWQgdG8gZmV0Y2ggZmlsZXNcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn07XHJcblxyXG4iXX0=